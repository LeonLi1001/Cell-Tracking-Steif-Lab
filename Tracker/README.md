# Tracker

This directory contains the scripts necessary for running the tracking algorithm, processing the tracks, and generating visualizations. The main script that users need to interact with is `runscript.py`.

## How to Use

### Step 1: Set Up Your Environment
Before running the tracking process, ensure that you have set up your Conda environment according to the provided environment file in the `env/` folder.

### Step 2: Running the Tracking Script
The only script that users need to run directly is `runscript.py`. This script coordinates the entire tracking and post-processing workflow.

#### 1. **Input Parameters:**
   - **Print Run:** In the first section of `runscript.py`, input the `printrun` (the specific run of your experiment).
   - **Dataset Name:** Input the `dataset_name` (the name of the dataset you're processing).

#### 2. **Execute the Script:**
   - After setting the parameters, execute the script by running:
     ```bash
     python runscript.py
     ```

### Step 3: Understanding the Processing Workflow

The tracking process consists of multiple stages, each designed to refine the tracks generated by the initial tracking algorithm. Hereâ€™s how the process works:

1. **Initial Tracking:**
   - The initial tracking process generates a `tracked` folder containing tracks without any post-processing applied.

2. **Track Again:**
   - The `track_again` process removes all stationary objects from the tracked data.

3. **Tracked Again Postprocessed:**
   - The `tracked_again_postprocessed` step processes sub-tracks based on predictions from a Random Forest classifier, which decides whether to keep, merge, or remove sub-tracks.

4. **Tracked Again Postprocessed 2.0:**
   - The final `tracked_again_postprocess_2.0` step pushes all tracks through additional filtering and adjustments based on specific tests.

### Step 4: Analyzing the Results

- **Visual Outputs:**
  - Visual outputs, including frame images and videos of the tracking results, are generated throughout the process. These outputs can be analyzed at each stage to determine the quality of the tracking.

- **Heterogeneity Consideration:**
  - Depending on the heterogeneity of your dataset, you may choose to stop processing at any stage or analyze the visual outputs to determine which is the best result.

### Step 5: Recommended Workflow
While you have the flexibility to stop at any processing stage based on your analysis, the recommended workflow is to run the script in its entirety. This will ensure that your tracks are fully processed and refined.

## Script Descriptions

- **runscript.py:**
  - This is the main script to run the entire tracking and post-processing workflow. Users need to input their specific `printrun` and `dataset_name` in this script.

- **features.py:**
  - Contains functions to calculate features used in the Random Forest classifier. These features help in deciding whether to keep, merge, or remove sub-tracks during post-processing.

- **loader.py:**
  - Contains functions to convert the images and segmentations into forms that are ready for processing. This is the first step in the tracking pipeline.

- **postprocess.py:**
  - Contains all the filtering steps applied to the tracks during post-processing. This includes the logic for removing stationary objects and refining sub-tracks.

- **visualizer.py:**
  - Generates visual images of the tracking results. This includes individual frame images as well as a compiled video of the tracking process.

**NOTE**: Prior to developing the pipeline based on the TRACKASTRA algorithm, I have attempted to try other prebuilt models such as ACDC, EmbedTrack, and YOLO. The models performed poorly on Isolatrix images and therefore not selected. Although the models may be a good fit if we train the models with our own images.  

## Conclusion

This workflow allows for a detailed and refined analysis of tracking data. Depending on the characteristics of your dataset, you can choose to analyze intermediate results or complete the entire process for the most refined output. The recommended approach is to run the full script and evaluate the final output.

